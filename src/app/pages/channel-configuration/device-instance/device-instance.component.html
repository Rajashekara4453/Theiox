<kl-serviceloader></kl-serviceloader>
<!-- <kl-mini-sidebar-menu [pageName]="'Channel Configuration'"></kl-mini-sidebar-menu> -->
<div class="main-content gateway-silo" [ngClass]="{'sensorContainer':devices}">
  <div class="sub-main-content bg-transparent">
    <div class="gateway-header overflow-visible p-0">
      <div class="button-group-container d-flex justify-content-left align-items-center align-center m-0 border-0"
        role="group" *ngIf="!showSearchFiled && !hideHeaderSettings">
        <!-- <svg enable-background="new 0 0 32 32" version="1.1" viewBox="0 0 32 32" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="Layer_2"/><g id="Layer_3"/><g id="Layer_4"/><g id="Layer_5"/><g id="Layer_6"/><g id="Layer_7"/><g id="Layer_8"/><g id="Layer_9"/><g id="Layer_10"/><g id="Layer_11"/><g id="Layer_12"/><g id="Layer_13"/><g id="Layer_14"/><g id="Layer_15"/><g id="Layer_16"/><g id="Layer_17"/><g id="Layer_18"/><g id="Layer_19"/><g id="Layer_20"/><g id="Layer_21"/><g id="Layer_22"/><g id="Layer_23"/><g id="Layer_24"><g><path d="M27,25v3c0,0.55-0.45,1-1,1H6c-0.55,0-1-0.45-1-1v-3c0-0.55,0.45-1,1-1h20C26.55,24,27,24.45,27,25z" fill="#96CEE5"/></g><g><path d="M7,19c-0.5522,0-1-0.4478-1-1v-6c0-0.5522,0.4478-1,1-1s1,0.4478,1,1v6C8,18.5522,7.5522,19,7,19z" fill="#4391B2"/></g><g><circle cx="7" cy="11" fill="#48B1DD" r="2"/></g><g><path d="M25,19c-0.5527,0-1-0.4478-1-1v-6c0-0.5522,0.4473-1,1-1s1,0.4478,1,1v6C26,18.5522,25.5527,19,25,19z" fill="#4391B2"/></g><g><circle cx="25" cy="11" fill="#48B1DD" r="2"/></g><g><path d="M31,20v3c0,1.65-1.35,3-3,3H4c-1.65,0-3-1.35-3-3v-3c0-1.65,1.35-3,3-3h24C29.65,17,31,18.35,31,20z" fill="red"/></g><g><circle cx="5.5" cy="21.5" fill="#96CEE5" r="1.5"/></g><g><circle cx="9.5" cy="21.5" fill="#96CEE5" r="1.5"/></g><g><circle cx="13.5" cy="21.5" fill="#96CEE5" r="1.5"/></g><g><path d="M8.9985,9c-0.2031,0-0.4082-0.0615-0.585-0.1899c-0.7539-0.5449-2.0742-0.5449-2.8281,0    c-0.4468,0.3247-1.0723,0.2236-1.396-0.2241c-0.3237-0.4473-0.2236-1.0723,0.2241-1.396c1.4502-1.0498,3.7217-1.0498,5.1719,0    c0.4478,0.3237,0.5479,0.9487,0.2241,1.396C9.6143,8.8564,9.3086,9,8.9985,9z" fill="#96CEE5"/></g><g><path d="M10.999,6.3188c-0.2183,0-0.438-0.0708-0.6221-0.2173c-1.8311-1.4561-4.9238-1.4561-6.7549,0    c-0.4321,0.3433-1.0615,0.272-1.4053-0.1602C1.873,5.5088,1.9448,4.8799,2.377,4.5361c2.5918-2.0615,6.6533-2.0615,9.2451,0    c0.4321,0.3438,0.5039,0.9727,0.1602,1.4053C11.585,6.1895,11.293,6.3188,10.999,6.3188z" fill="#96CEE5"/></g><g><path d="M26.999,9c-0.2031,0-0.4082-0.0615-0.585-0.1899c-0.7539-0.5449-2.0742-0.5449-2.8281,0    c-0.4473,0.3237-1.0723,0.2231-1.3965-0.2241c-0.3232-0.4473-0.2227-1.0723,0.2246-1.396c1.4492-1.0498,3.7227-1.0498,5.1719,0    c0.4473,0.3237,0.5479,0.9487,0.2246,1.396C27.6143,8.8564,27.3086,9,26.999,9z" fill="#96CEE5"/></g><g><path d="M28.999,6.3188c-0.2178,0-0.4375-0.0708-0.6211-0.2173c-1.832-1.4561-4.9238-1.4561-6.7559,0    c-0.4326,0.3447-1.0625,0.2705-1.4043-0.1602c-0.3438-0.4326-0.2725-1.0615,0.1602-1.4053c2.5918-2.0615,6.6523-2.0615,9.2441,0    c0.4326,0.3438,0.5039,0.9727,0.1602,1.4053C29.585,6.1895,29.2939,6.3188,28.999,6.3188z" fill="#96CEE5"/></g></g><g id="Layer_25"/><g id="Layer_26"/><g id="Layer_27"/><g id="Layer_28"/><g id="Layer_29"/><g id="Layer_30"/><g id="Layer_31"/></svg>  -->
        <!-- <select class="h6 select-title border text-muted">
          <option>&#xf18c; Gateways and Sensors</option>
          <option>&#xf18c; Gateways</option>
          <option>&#xf1a5; Sensors</option>
        </select> -->
        <!-- <ng-select [items]="viewDropDownItems" bindLabel="name" bindValue="id"
        placeholder="Select Sensor" [searchable]="true" [clearable]="false" [selectOnTab]="true"
        [(ngModel)]="viewDropDownItemChange" (change)="viewDropDownChange(viewDropDownItemChange)" class="select-gateway-title">
        <ng-template ng-label-tmp let-item="item">
          <i class="{{item.icon}} pr-1"></i>
            <span>{{item.name}}</span>
        </ng-template>
        <ng-template ng-option-tmp let-item="item" let-index="index">
          <i class="{{item.icon}} pr-1"></i>
            <span>{{item.name}}</span>
        </ng-template>
      </ng-select> -->

        <div class="dropdown select-gateway-title border" *ngIf="viewDropDownItems">
          <button class="btn btn-secondary dropdown-toggle header-title shadow-none padding-right-0 border-0"
            type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="{{dropDownLable.icon}}"></i> {{dropDownLable.name}}
          </button>
          <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
            <a class="dropdown-item" *ngFor="let item of viewDropDownItems"
              (click)="onSelectValue(item.id,item.name,item.icon)"> <i class="{{item.icon}}"></i> {{item.name}}</a>
          </div>
        </div>

        <!-- <h6 class="control-label text-muted m-0"></h6> -->
      </div>
      <div class="button-group-container ml-auto" role="group" *ngIf="!showSearchFiled  && !hideHeaderSettings">
        <!-- <button type="button" class="btn btn-secondary border-left-0 border-bottom-0 border-top-0 border-right"
          (click)="togglesearch()" [ngClass]="{'border-left':!togglesearchbutton}">
          <i class="elm-search"></i>
        </button> -->
        <div class="search-group" tabindex="1" [ngClass]="{'addwidth border-left-0':togglesearchbutton}">
          <i class="search-icon fa fa-search"></i>
          <input type="search" [(ngModel)]="queryString" class="search-input" placeholder="Search"
            (input)="onKey($event)">
        </div>
      </div>
      <div class="button-group-container d-flex justify-content-right" role="group"
        *ngIf="!showSearchFiled && !hideHeaderSettings">
        <div class="button-group d-flex" role="group">
          <button type="button" class="btn btn-secondary shadow-none gatewaytitle-with-icon" (click)="goToGatewayPage()"
            title="Gateways"></button>
          <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#exampleGatewayModal"
            (click)="openGatewayModel()" title="Create Gateway"><i class="elm-add-2 h5"></i></button>
          <button class="btn btn-secondary text-primary" type="button" data-toggle="tooltip" *ngIf="gatewayInfo"
            data-placement="bottom" title="All" (click)="applyFilter('All')">{{gatewayInfo.allGatewayCount}}</button>
          <button type="button" class="btn btn-secondary text-success" data-toggle="tooltip" *ngIf="gatewayInfo"
            data-placement="bottom" title="Active"
            (click)="applyFilter('active')">{{gatewayInfo.activeGatewayCount}}</button>
          <button class="btn btn-secondary text-danger" data-toggle="tooltip" *ngIf="gatewayInfo"
            data-placement="bottom" title="Inactive"
            (click)="applyFilter('inactive')">{{gatewayInfo.inactiveGatewayCount}}</button>
          <button type="button" *ngIf="gatewayInfo && gatewayInfo.deletedGatewayCount > 0"
            class="btn btn-secondary text-dark" data-toggle="tooltip" data-placement="top" title="Deleted Gateways"
            data-toggle="tooltip" data-placement="bottom" title="Delete"
            (click)="applyFilter('delete')">{{gatewayInfo.deletedGatewayCount}}</button>
          <button type="button" *ngIf="gatewayInfo && gatewayInfo.disabledGatewayCount > 0"
            class="btn btn-secondary text-secondary" data-toggle="tooltip" data-placement="top"
            title="Disabled Gateways" data-toggle="tooltip" data-placement="bottom" title="Disable"
            (click)="applyFilter('disable')">{{gatewayInfo.disabledGatewayCount}}</button>


          <button class="btn btn-secondary text-primary" type="button" data-toggle="tooltip"
            *ngIf="gatewayInfo  === undefined" data-placement="bottom" title="All"
            (click)="applyFilter('All')">--</button>
          <button type="button" class="btn btn-secondary text-success" data-toggle="tooltip"
            *ngIf="gatewayInfo === undefined" data-placement="bottom" title="Active"
            (click)="applyFilter('active')">--</button>
          <button class="btn btn-secondary text-danger" data-toggle="tooltip" *ngIf="gatewayInfo === undefined"
            data-placement="bottom" title="Inactive" (click)="applyFilter('inactive')">--</button>

        </div>
      </div>
      <div class="button-group-container d-flex justify-content-right" *ngIf="!showSearchFiled  && !hideHeaderSettings">
        <div class="button-group d-flex" role="group">
          <!-- <button type="button" class="btn btn-secondary active shadow-none" (click)="onSave()">Gateways</button> -->
          <button type="button" class="btn btn-secondary shadow-none devicetitle-with-icon" title="Sensors"></button>
          <button type="button" class="btn btn btn-secondary" data-toggle="modal" data-placement="bottom"
            title="Create Sensor" data-target="#exampleDeviceModal" (click)="clearSearchText()"><i
              class="elm-add-2 h5"></i></button>
          <button #fileInput [hidden]="true" data-toggle="modal" data-target="#exampleModal"></button>
          <button type="button" class="btn btn-secondary text-primary" (click)="allDevices('All')" data-toggle="tooltip"
            data-placement="bottom" title="All Sensor"
            *ngIf="deviecsStatusCount">{{deviecsStatusCount.deviceCount}}</button>
          <button type="button" class="btn btn-secondary text-success" (click)="allDevices('active')"
            data-toggle="tooltip" data-placement="bottom" title="Active"
            *ngIf="deviecsStatusCount">{{deviecsStatusCount.activeDeviceCount}}</button>
          <button type="button" class="btn btn-secondary text-danger" (click)="allDevices('inactive')"
            data-toggle="tooltip" data-placement="bottom" title="Inactive"
            *ngIf="deviecsStatusCount">{{deviecsStatusCount.inactiveDeviceCount}}</button>
          <button type="button" class="btn btn-secondary text-dark"
            *ngIf="deviecsStatusCount && deviecsStatusCount.deleteCount > 0" (click)="allDevices('delete')"
            data-toggle="tooltip" data-placement="bottom" title="Deleted">{{deviecsStatusCount.deleteCount}}</button>
          <button type="button" class="btn btn-secondary text-secondary"
            *ngIf="deviecsStatusCount && deviecsStatusCount.disableCount > 0" (click)="allDevices('disable')"
            data-toggle="tooltip" data-placement="bottom" title="Disabled">{{deviecsStatusCount.disableCount}}</button>


          <button type="button" class="btn btn-secondary text-primary" (click)="allDevices('All')" data-toggle="tooltip"
            data-placement="bottom" title="All Sensor" *ngIf="deviecsStatusCount  === undefined"> -- </button>
          <button type="button" class="btn btn-secondary text-success" (click)="allDevices('active')"
            data-toggle="tooltip" data-placement="bottom" title="Active" *ngIf="deviecsStatusCount === undefined">
            --</button>
          <button type="button" class="btn btn-secondary text-danger" (click)="allDevices('inactive')"
            data-toggle="tooltip" data-placement="bottom" title="Inactive" *ngIf="deviecsStatusCount === undefined"> --
          </button>
        </div>
      </div>
      <div class="button-group-container d-flex" *ngIf="!showSearchFiled  && !hideHeaderSettings">
        <ng-container *ngIf="!showSearchFiled  && !hideHeaderSettings">
          <label for="name"
            class="control-label d-flex align-items-center justify-content-right m-0 px-2 text-truncate">Filter
            by:</label>
        </ng-container>
        <div class="dropdowncontainer">
          <ng-select [items]="options" bindLabel="gatewayname" bindValue="gateway_instance_id"
            placeholder="Select Gateway" [searchable]="true" [clearable]="false" [selectOnTab]="true"
            [(ngModel)]="gatewayChange" (change)="onChangeGateway(gatewayChange)" (clear)="clearGatewaySelection()">
            <ng-template ng-label-tmp let-item="item">
              <i *ngIf="item.devices" class="gatewaytitle-with-icon pr-2"></i>
              <span>{{item.gatewayname}}</span>
            </ng-template>
            <ng-template ng-option-tmp let-item="item" let-index="index">
              <i *ngIf="item.devices" class="gatewaytitle-with-icon pr-2"></i>
              <span>{{item.gatewayname}}</span>
            </ng-template>
          </ng-select>
        </div>
        <button *ngIf="EditGateway && !showSearchFiled && !hideHeaderSettings" type="button"
          class="btn btn-secondary border-left-0 bg-white box-shadow-0" style="background: white"
          (click)="onDeviceSettingClick()" data-toggle="modal" data-target="#gatewaycreation" title="Edit"><i
            class="elm-edit-2"></i></button>

      </div>
      <!-- </div> -->
      <ng-container *ngIf="showSearchFiled && !hideHeaderSettings">
        <!-- <div class="mr-auto"> -->

        <!-- </div> -->
      </ng-container>
      <div class="button-group-container d-flex title-same border-0 mr-auto" role="group"
        *ngIf="showSearchFiled  && !hideHeaderSettings">
        <!-- <button type="button" class="btn btn-secondary border-right-0 active shadow-none"></button> -->
        <!-- <label
          class="control-label d-flex align-items-center justify-content-right m-0 px-2 border border-right-0 bg-white">
          Sensor :

        </label> -->
        <!-- </button> -->
        <h6 for="name" class="devicetitle text-muted m-0 devicetitle-with-icon d-flex align-items-center pl-1">
          {{device_model_text}} :</h6>
        <div class="dropdowncontainer" *ngIf="showSearchFiled  && !hideHeaderSettings">
          <ng-select [items]="totalDevicesInList" bindLabel="device_name" bindValue="device_instance_id"
            placeholder="Select Sensor" [searchable]="true" [clearable]="false" [selectOnTab]="true"
            [(ngModel)]="sensorChange" (change)="onChangeSensor(sensorChange)" groupBy="gatewayname">
            <!-- <ng-template ng-label-tmp let-item="item">
              <i class="elm-online pr-2"></i>
              <span>{{item.device_name}}</span>
            </ng-template> -->
            <ng-template ng-optgroup-tmp let-item="item">
              <i class="gatewaytitle-with-icon"></i>
              {{item.gatewayname}}
            </ng-template>
            <ng-template ng-option-tmp let-item="item" let-index="index">
              <i class="elm-online pr-2"></i>
              <span>{{item.name}}</span>
            </ng-template>
            <ng-template ng-label-tmp let-item="item" let-clear="clear">
              <span class="ng-value-label">
                {{item.gatewayname && !item.name ? item.group: item.name}}
              </span>
            </ng-template>
          </ng-select>
        </div>
      </div>
      <!-- <ng-container *ngIf="showSearchFiled  && !hideHeaderSettings" class="col-md-1">
        <div>
          <label for="name" class="control-label">&nbsp; Choose Sensor</label>
        </div>
      </ng-container>
      <div class="dropdowncontainer col-md-2" *ngIf="showSearchFiled  && !hideHeaderSettings">
        <ng-select [items]="totalDevicesInList" bindLabel="device_name" bindValue="device_instance_id"
          placeholder="Select Sensor" [searchable]="true" [clearable]="true" [selectOnTab]="true"
          [(ngModel)]="sensorChange" (change)="onChangeSensor(sensorChange)">
        </ng-select>
      </div> -->
      <ng-container *ngIf="hideHeaderSettings">
        <div class="button-group-container button-group-container mx-2 d-flex">
          <h6 for="name" class="control-label text-muted m-0 devicetitle-with-icon">{{device_model_text}}</h6>
        </div>
      </ng-container>
      <div class="button-group-container button-group-container ml-auto mx-2 d-flex" role="group"
        *ngIf="hideHeaderSettings">
        <label for="name"
          class="control-label d-flex align-items-center justify-content-right m-0 px-2 border border-right-0 bg-white">Gateway
          :</label>

        <div class="dropdowncontainer">
          <ng-select [items]="totalGatewaysInList" bindLabel="gatewayname" bindValue="gateway_instance_id"
            placeholder="Select Sensor" [searchable]="true" [clearable]="false" [selectOnTab]="true"
            [(ngModel)]="onCreateGatewayChange" (change)="onCreateChangeGateway(onCreateGatewayChange)">
            <ng-template ng-label-tmp let-item="item">
              <i class="gatewaytitle-with-icon pr-2"></i>
              <span>{{item.gatewayname}}</span>
            </ng-template>
            <ng-template ng-option-tmp let-item="item" let-index="index">
              <i class="gatewaytitle-with-icon pr-2"></i>
              <span>{{item.gatewayname}}</span>
            </ng-template>
          </ng-select>
        </div>
      </div>
    </div>
    <ng-container *ngIf="dmf">
      <kl-device-configuration [deviceInfo]="deviceModelInfo" [deviceEdit]="deviceEditInfo"
        (createDevice)="createdDevice($event)" [deviceInstanceId]="device_instance_id"
        (deviceConfigToSilo)="deviceToSiloView($event)" [deviceModelIdFromDeviceModel]="deviceModelIdFromDeviceModel"
        [deviceModelIdFromPopUpModel]="deviceModelIdFromPopUpModel" (refershSensors)="refreshSensors($event)">
      </kl-device-configuration>
    </ng-container>
    <ng-container *ngIf="devices">
      <kl-device [devicesInGateway]="createDevice" (deviceInformation)="onDeviceClick($event)" [search]="searchVal"
        (deviceStatusInfo)="updateStatus($event)" [filter]="filterVal">
      </kl-device>
    </ng-container>
    <!-- <ng-container *ngIf="deviceModel">
      <div class="col-md-10">
        <label for="name" class="control-label">&nbsp; + Add using Device Model</label>
      </div>
    </ng-container> -->
  </div>
</div>
<div *ngIf="showorHideGateway" class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable h-100" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title col-md-8 devicetitle-with-icon text-muted" id="exampleModalCenterTitle">Create Sensor
        </h6>
        <!-- <div class="custom-file mb-3" *ngIf="!hidefileUploadFiled">
          <input type="file" class="custom-file-input" id="customFile" name="filename"
            (change)="onChange($event.target.files)">
          <label class="custom-file-label" for="customFile">{{fileUploadlabel}}</label>
        </div> -->
        <div class="search-group" tabindex="1">
          <span class="fa fa-search search-icon"></span>
          <input type="search" [(ngModel)]="searchSensorModel" class="search-input" placeholder='Search'>
        </div>
        <button aria-label="Close" class="close mx-0" data-dismiss="modal" type="button"><i
            class="elm-cancel cancel-elm"></i></button>
      </div>
      <div class="modal-body form-body">
        <div class="h-100 position-relative" *ngIf="!deviceTagList || !sideMenus">
          <div class="lds-ring">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>
        <div class="h-100" *ngIf="deviceTagList && sideMenus">
          <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
              <a *ngFor="let tag of deviceTagList" id="nav-{{tag.name}}-tab" data-toggle="tab" href="#nav-{{tag.name}}"
                role="tab" aria-selected="true"
                [ngClass]="(tag.name === 'Library')?'nav-item nav-link active':'nav-item nav-link'">{{tag.name}}</a>
              <a id="nav-add-tab" role="tab" class="nav-item nav-link" data-toggle="tab"
                (click)="onCustomClick()">Create
                Custom Sensor</a>
            </div>
          </nav>
          <div class="tab-content" id="nav-tabContent">
            <div id="nav-{{tag.name}}" class="clearfix" *ngFor="let tag of deviceTagList"
              [ngClass]="(tag.name === 'Library')?'tab-pane fade show active':'tab-pane fade'">
              <ng-container class="" *ngFor="let module of sideMenus | elmfilter:searchSensorModel:['name']:true:2">
                <div class="element-item" *ngIf="existsInArray(module.dvtags,tag.name)" (click)='getDeviceData(module)'
                  data-toggle="tooltip" data-placement="top" title="{{module.name}}">
                  <p class="name" *ngIf="module.name">
                    {{module.name}}
                  </p>
                </div>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" hidden="hidden" class="btn btn-secondary" data-dismiss="modal" #close>Close</button>
        <button type="button" class="btn btn-sm btn-secondary" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="gatewaycreation" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable h-100" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title text-muted gatewaytitle-with-icon">{{gatewayTitle}}</h6>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span class="elm-cancel cancel-elm" aria-hidden="true"></span>
        </button>
      </div>
      <div class="modal-body form-body">
        <div class="h-100 position-relative" *ngIf="!dmfData">
          <div class="lds-ring">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>
        <!-- <kl-serviceloader ></kl-serviceloader> -->
        <ng-container *ngIf="dmfData">
          <kl-dfm *ngIf="DFMinput" [DFMDATA]="DFMinput"
            (SelectedValues)="accessLevel.create ? getselectedValues($event) : return" (cancel)="onDFMCancel()"
            (showFields)="showFields($event)" [disableBtn]="disableBtn"></kl-dfm>
        </ng-container>
      </div>
      <div class="modal-footer d-none">
        <button type="button" hidden="hidden" class="btn btn-secondary btn-sm" data-dismiss="modal"
          #gatewaycreationval>Cancel</button>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="exampleGatewayModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-scrollable h-100" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title col-md-8 text-muted gatewaytitle-with-icon" id="exampleModalCenterTitle">Create Gateway
        </h6>
        <!-- <div class="custom-file" *ngIf="!hideSiloButton">
          <input type="file" class="custom-file-input" id="customFile" name="filename"
            (change)="onChange($event.target.files)">
          <label class="custom-file-label" for="customFile">{{fileUploadlabel}}</label>
        </div> -->
        <div class="search-group ml-auto" tabindex="1">
          <span class="fa fa-search search-icon"></span>
          <input type="search" [(ngModel)]="searchGatewayModel" class="search-input" placeholder='Search'>
        </div>
        <button aria-label="Close" class="close mx-0" data-dismiss="modal" type="button"><i
            class="elm-cancel cancel-elm"></i></button>
      </div>
      <div class="modal-body form-body">
        <div class="h-100 position-relative" *ngIf="!tagsDisplay || !allModules">
          <div class="lds-ring">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
          </div>
        </div>
        <div class="h-100" *ngIf="tagsDisplay || allModules">
          <nav>
            <div class="nav nav-tabs" id="nav-tab" role="tablist">
              <a *ngFor="let tag of tagsDisplay" id="nav-{{tag.name}}-tab" data-toggle="tab" href="#nav-{{tag.name}}"
                role="tab" aria-selected="true"
                [ngClass]="(tag.name === 'All')?'nav-item nav-link active':'nav-item nav-link'">{{tag.name}}</a>
            </div>
          </nav>
          <div class="tab-content" id="nav-tabContent">
            <div id="nav-{{tag.name}}" class="clearfix" *ngFor="let tag of tagsDisplay"
              [ngClass]="(tag.name === 'All')?'tab-pane fade show active':'tab-pane fade'">
              <ng-container class=""
                *ngFor="let module of allModules | elmfilter:searchGatewayModel:['gatewaymodelname','name']:true:2">
                <div class="element-item" *ngIf="existsInGatewayArray(module.gwtags,tag.name)"
                  (click)='module.gateway_id ? onCreateGateway(module.gateway_id,module.gwtags): onCreateGateway(module.id,module.gwtags)'
                  data-toggle="modal" data-target="#gatewaycreation"
                  [attr.title]="module.gatewaymodelname ? module.gatewaymodelname : module.name">
                  <p class="name" *ngIf="module.gatewaymodelname">
                    {{module.gatewaymodelname}}
                  </p>
                  <p class="name" *ngIf="module.name">
                    {{module.name}}
                  </p>
                </div>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" hidden="hidden" class="btn btn-secondary" data-dismiss="modal"
          #gatewayclose>Close</button>
        <button type="button" class="btn btn-sm btn-secondary border" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="exampleDeviceModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title text-muted devicetitle-with-icon">Create Sensor</h6>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span class="elm-cancel cancel-elm" aria-hidden="true"></span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group row">
          <label for='tagname' class="col-sm-3 col-form-label">Gateway *</label>
          <div class="col-sm-9" *ngIf="createsSensorGatewayList">
            <!-- <angular2-multiselect [data]="createsSensorGatewayList" [(ngModel)]="gatewaySelectionid"
              [settings]="gatewayDropdownSettings" class="form-control p-0" name="device" (onDeSelectAll)="onDeSelectAll($event)"></angular2-multiselect>
          </div> -->
            <ng-select [items]="createsSensorGatewayList" bindLabel="gatewayname" bindValue="gateway_instance_id"
              placeholder="Select Gateway" [searchable]="true" [clearable]="true" [selectOnTab]="true"
              [(ngModel)]="gatewaySelectionid" (change)="onChangeGatewaySelectionId(gatewaySelectionid)">
              <ng-template ng-label-tmp let-item="item">
                <i class="gatewaytitle-with-icon pr-2"></i>
                <span>{{item.gatewayname}}</span>
              </ng-template>
              <ng-template ng-option-tmp let-item="item" let-index="index">
                <i class="gatewaytitle-with-icon pr-2"></i>
                <span>{{item.gatewayname}}</span>
              </ng-template>
            </ng-select>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" hidden="hidden" class="btn btn-secondary btn-sm" data-dismiss="modal"
          #gatewaySelctionclose>Cancel</button>
        <button type="button" class="btn-sm btn btn-primary" (click)="onAddDevice()">Continue</button>
      </div>
    </div>
  </div>
</div>